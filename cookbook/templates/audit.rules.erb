#
# /etc/audit/rules.d/99-stig.rules
#
# Generated by Chef for <%= node['fqdn'] %>
#

## First rule - delete all
-D

## Increase the buffers to survive stress events.
## Make this bigger for busy systems
-b 8192

## This determine how long to wait in burst of events
--backlog_wait_time 60000

<% @rules.each do |name, rule| %>
<% next unless rule['managed'] %>
<% next if rule['packages'] %>
<% if rule['rule'] %>
# <%= name %>  - <%= rule['title'] %>
<%= rule['rule'] %>
<% end %>
<% if rule['rules'] %>
# <%= name %> - <%= rule['title'] %>
<% rule['rules'].each do |subrule| %>
<%= subrule %>
<% end %>
<% end %>

<% end %>